#include "DxLib.h"
#include "Config.h"
#include "Game.h"
#include "Menu.h"
#include "Pause.h"
#include "SceneMgr.h"

SceneMgr::SceneMgr() :
	mNextScene( eScene_None ) //次のシーン管理変数
{
	mScene = (BaseScene*) new Menu( this );
}

//初期化
void SceneMgr::Initialize()
{
	temp_flag = false;
	mScene->Initialize();
}

//終了処理
void SceneMgr::Finalize()
{
	mScene->Finalize();
}

//更新
void SceneMgr::Update()
{
	//次のシーンがセットされていたら
	if (mNextScene != eScene_None)
	{
		//if (mNextScene == eScene_Pause)
		//{
			//temp_mScene = mScene;
			//temp_flag = true;
		//}
		////else
		//{
		mScene->Finalize();//現在のシーンの終了処理を実行
		delete mScene;
	//}


		switch (mNextScene)
		{       //シーンによって処理を分岐
			case eScene_Menu:        //次の画面がメニューなら
				mScene = (BaseScene*) new Menu( this );   //メニュー画面のインスタンスを生成する
				break;//以下略

			case eScene_Game:
				//if (temp_flag)
				//{
					//mScene = temp_mScene;
					//temp_flag = false;
				//}
				//else
				//{
				mScene = (BaseScene*) new Game( this );
			//}
				break;

			case eScene_Config:
				mScene = (BaseScene*) new Config( this );
				break;

			case eScene_Pause:
				mScene = (BaseScene*) new Pause( this );
				break;

		}
		mNextScene = eScene_None;    //次のシーン情報をクリア
		mScene->Initialize();    //シーンを初期化
	}

	mScene->Update(); //シーンの更新
}

//描画
void SceneMgr::Draw()
{
	mScene->Draw(); //シーンの描画
}

// 引数 nextScene にシーンを変更する
void SceneMgr::ChangeScene( eScene NextScene )
{
	mNextScene = NextScene;    //次のシーンをセットする
}